(function(G,w){"object"===typeof exports&&"undefined"!==typeof module?module.exports=w():"function"===typeof define&&define.amd?define(w):G.formula=w()})(this,function(){var G=function(w){var k=function(){var g={};g.nil=Error("#NULL!");g.div0=Error("#DIV/0!");g.value=Error("#VALUE!");g.ref=Error("#REF!");g.name=Error("#NAME?");g.num=Error("#NUM!");g.na=Error("#N/A");g.error=Error("#ERROR!");g.data=Error("#GETTING_DATA");return g}(),e=function(){var g={flattenShallow:function(a){return a&&a.reduce?
a.reduce(function(c,d){var f=Array.isArray(c),h=Array.isArray(d);return f&&h?c.concat(d):f?(c.push(d),c):h?[c].concat(d):[c,d]}):a},isFlat:function(a){if(!a)return!1;for(var c=0;c<a.length;++c)if(Array.isArray(a[c]))return!1;return!0},flatten:function(){for(var a=g.argsToArray.apply(null,arguments);!g.isFlat(a);)a=g.flattenShallow(a);return a},argsToArray:function(a){var c=[];g.arrayEach(a,function(d){c.push(d)});return c},numbers:function(){return this.flatten.apply(null,arguments).filter(function(a){return"number"===
typeof a})},cleanFloat:function(a){return Math.round(1E14*a)/1E14},parseBool:function(a){if("boolean"===typeof a||a instanceof Error)return a;if("number"===typeof a)return 0!==a;if("string"===typeof a){var c=a.toUpperCase();if("TRUE"===c)return!0;if("FALSE"===c)return!1}return a instanceof Date&&!isNaN(a)?!0:k.value},parseNumber:function(a){return void 0===a||""===a?k.value:isNaN(a)?k.value:parseFloat(a)},parseNumberArray:function(a){var c;if(!a||0===(c=a.length))return k.value;for(var d;c--;){d=
g.parseNumber(a[c]);if(d===k.value)return d;a[c]=d}return a},parseMatrix:function(a){if(!a||0===a.length)return k.value;for(var c,d=0;d<a.length;d++)if(c=g.parseNumberArray(a[d]),a[d]=c,c instanceof Error)return c;return a}},b=new Date(Date.UTC(1900,0,1));g.parseDate=function(a){if(!isNaN(a)){if(a instanceof Date)return new Date(a);a=parseInt(a,10);return 0>a?k.num:60>=a?new Date(b.getTime()+864E5*(a-1)):new Date(b.getTime()+864E5*(a-2))}return"string"!==typeof a||(a=new Date(a),isNaN(a))?k.value:
a};g.parseDateArray=function(a){for(var c=a.length,d;c--;){d=this.parseDate(a[c]);if(d===k.value)return d;a[c]=d}return a};g.anyIsError=function(){for(var a=arguments.length;a--;)if(arguments[a]instanceof Error)return!0;return!1};g.arrayValuesToNumbers=function(a){for(var c=a.length,d;c--;)d=a[c],"number"!==typeof d&&(!0===d?a[c]=1:!1===d?a[c]=0:"string"===typeof d&&(d=this.parseNumber(d),a[c]=d instanceof Error?0:d));return a};g.rest=function(a,c){return a&&"function"===typeof a.slice?a.slice(c||
1):a};g.initial=function(a,c){return a&&"function"===typeof a.slice?a.slice(0,a.length-(c||1)):a};g.arrayEach=function(a,c){for(var d=-1,f=a.length;++d<f&&!1!==c(a[d],d,a););return a};g.transpose=function(a){return a?a[0].map(function(c,d){return a.map(function(f){return f[d]})}):k.value};return g}(),y={};y.datetime=function(){function g(d){return(d-a)/864E5+(-22038912E5<d?2:1)}var b={},a=new Date(1900,0,1),c=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],
[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];b.DATE=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:new Date(d,f-1,h)};b.DATEVALUE=function(d){if("string"!==typeof d)return k.value;d=Date.parse(d);return isNaN(d)?k.value:-22038912E5>=d?(d-a)/864E5+1:(d-a)/864E5+2};b.DAY=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getDate()};b.DAYS=function(d,f){d=e.parseDate(d);
f=e.parseDate(f);return d instanceof Error?d:f instanceof Error?f:g(d)-g(f)};b.DAYS360=function(d,f,h){};b.EDATE=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);d.setMonth(d.getMonth()+f);return g(d)};b.EOMONTH=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;if(isNaN(f))return k.value;f=parseInt(f,10);return g(new Date(d.getFullYear(),d.getMonth()+f+1,0))};b.HOUR=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getHours()};
b.INTERVAL=function(d){if("number"!==typeof d&&"string"!==typeof d)return k.value;d=parseInt(d,10);var f=Math.floor(d/94608E4);d%=94608E4;var h=Math.floor(d/2592E3);d%=2592E3;var l=Math.floor(d/86400);d%=86400;var m=Math.floor(d/3600);d%=3600;var n=Math.floor(d/60);d%=60;return"P"+(0<f?f+"Y":"")+(0<h?h+"M":"")+(0<l?l+"D":"")+"T"+(0<m?m+"H":"")+(0<n?n+"M":"")+(0<d?d+"S":"")};b.ISOWEEKNUM=function(d){d=e.parseDate(d);if(d instanceof Error)return d;d.setHours(0,0,0);d.setDate(d.getDate()+4-(d.getDay()||
7));var f=new Date(d.getFullYear(),0,1);return Math.ceil(((d-f)/864E5+1)/7)};b.MINUTE=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMinutes()};b.MONTH=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getMonth()+1};b.NETWORKDAYS=function(d,f,h){};b.NETWORKDAYS.INTL=function(d,f,h,l){};b.NOW=function(){return new Date};b.SECOND=function(d){d=e.parseDate(d);return d instanceof Error?d:d.getSeconds()};b.TIME=function(d,f,h){d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);
return e.anyIsError(d,f,h)?k.value:0>d||0>f||0>h?k.num:(3600*d+60*f+h)/86400};b.TIMEVALUE=function(d){d=e.parseDate(d);return d instanceof Error?d:(3600*d.getHours()+60*d.getMinutes()+d.getSeconds())/86400};b.TODAY=function(){return new Date};b.WEEKDAY=function(d,f){d=e.parseDate(d);if(d instanceof Error)return d;void 0===f&&(f=1);d=d.getDay();return c[f][d]};b.WEEKNUM=function(d,f){};b.WORKDAY=function(d,f,h){};b.WORKDAY.INTL=function(d,f,h,l){};b.YEAR=function(d){d=e.parseDate(d);return d instanceof
Error?d:d.getFullYear()};b.YEARFRAC=function(d,f,h){};return b}();y.database=function(){function g(a,c){for(var d={},f=1;f<a[0].length;++f)d[f]=!0;var h=c[0].length;for(f=1;f<c.length;++f)c[f].length>h&&(h=c[f].length);for(f=1;f<a.length;++f)for(var l=1;l<a[f].length;++l){for(var m=!1,n=!1,p=0;p<c.length;++p){var q=c[p];if(!(q.length<h)&&a[f][0]===q[0]){n=!0;for(var t=1;t<q.length;++t)m=m||eval(a[f][l]+q[t])}}n&&(d[l]=d[l]&&m)}c=[];for(h=0;h<a[0].length;++h)d[h]&&c.push(h-1);return c}var b={FINDFIELD:function(a,
c){for(var d=null,f=0;f<a.length;f++)if(a[f][0]===c){d=f;break}return null==d?k.value:d},DAVERAGE:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);for(var f=c=0;f<d.length;f++)c+=a[d[f]];return 0===d.length?k.div0:c/d.length},DCOUNT:function(a,c,d){},DCOUNTA:function(a,c,d){},DGET:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):
a=e.rest(a[c]);return 0===d.length?k.value:1<d.length?k.num:a[d[0]]},DMAX:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);c=a[d[0]];for(var f=1;f<d.length;f++)c<a[d[f]]&&(c=a[d[f]]);return c},DMIN:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);"string"===typeof c?(c=b.FINDFIELD(a,c),a=e.rest(a[c])):a=e.rest(a[c]);c=a[d[0]];for(var f=1;f<d.length;f++)c>a[d[f]]&&(c=a[d[f]]);return c},
DPRODUCT:function(a,c,d){if(isNaN(c)&&"string"!==typeof c)return k.value;d=g(a,d);if("string"===typeof c){c=b.FINDFIELD(a,c);var f=e.rest(a[c])}else f=e.rest(a[c]);a=[];for(c=0;c<d.length;c++)a[c]=f[d[c]];if(d=a)for(a=[],c=0;c<d.length;++c)d[c]&&a.push(d[c]);else a=d;d=1;for(c=0;c<a.length;c++)d*=a[c];return d},DSTDEV:function(a,c,d){},DSTDEVP:function(a,c,d){},DSUM:function(a,c,d){},DVAR:function(a,c,d){},DVARP:function(a,c,d){},MATCH:function(a,c,d){if(!a&&!c)return k.na;2===arguments.length&&(d=
1);if(!(c instanceof Array)||-1!==d&&0!==d&&1!==d)return k.na;for(var f,h,l=0;l<c.length;l++)if(1===d){if(c[l]===a)return l+1;c[l]<a&&(h?c[l]>h&&(f=l+1,h=c[l]):(f=l+1,h=c[l]))}else if(0===d)if("string"===typeof a){if(a=a.replace(/\?/g,"."),c[l].toLowerCase().match(a.toLowerCase()))return l+1}else{if(c[l]===a)return l+1}else if(-1===d){if(c[l]===a)return l+1;c[l]>a&&(h?c[l]<h&&(f=l+1,h=c[l]):(f=l+1,h=c[l]))}return f?f:k.na}};return b}();y.engineering=function(){var g={BESSELI:function(b,a){},BESSELJ:function(b,
a){},BESSELK:function(b,a){},BESSELY:function(b,a){},BIN2DEC:function(b){if(!/^[01]{1,10}$/.test(b))return k.num;var a=parseInt(b,2);b=b.toString();return 10===b.length&&"1"===b.substring(0,1)?parseInt(b.substring(1),2)-512:a},BIN2HEX:function(b,a){if(!/^[01]{1,10}$/.test(b))return k.num;var c=b.toString();if(10===c.length&&"1"===c.substring(0,1))return(0xfffffffe00+parseInt(c.substring(1),2)).toString(16);b=parseInt(b,2).toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;
a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BIN2OCT:function(b,a){if(!/^[01]{1,10}$/.test(b))return k.num;var c=b.toString();if(10===c.length&&"1"===c.substring(0,1))return(1073741312+parseInt(c.substring(1),2)).toString(8);b=parseInt(b,2).toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},BITAND:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>
b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b&a},BITLSHIFT:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||Math.floor(b)!==b||0xffffffffffff<b||53<Math.abs(a)?k.num:0<=a?b<<a:b>>-a},BITOR:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b|a},BITRSHIFT:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);
return e.anyIsError(b,a)?k.value:0>b||Math.floor(b)!==b||0xffffffffffff<b||53<Math.abs(a)?k.num:0<=a?b>>a:b<<-a},BITXOR:function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:0>b||0>a||Math.floor(b)!==b||Math.floor(a)!==a||0xffffffffffff<b||0xffffffffffff<a?k.num:b^a},COMPLEX:function(b,a,c){b=e.parseNumber(b);a=e.parseNumber(a);if(e.anyIsError(b,a))return b;c=void 0===c?"i":c;return"i"!==c&&"j"!==c?k.value:0===b&&0===a?0:0===b?1===a?c:a.toString()+c:0===a?b.toString():
b.toString()+(0<a?"+":"")+(1===a?c:a.toString()+c)},CONVERT:function(b,a,c){b=e.parseNumber(b);if(b instanceof Error)return b;for(var d=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414E-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576E-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182E-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["a.u. of time","?/Eh",null,"time",!1,
!1,2.41888432650516E-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\u00e5ngstr\u00f6m","\u00c5",["ang"],"length",!1,!0,1E-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667E-11],["bar","bar",null,"pressure",!1,!1,1E5],["barn","b",null,"area",!1,!1,1E-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],
"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \u00e5ngstr\u00f6m","ang3",["ang^3"],"volume",!1,!0,1E-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,1.6387064E-5],["cubic light-year","ly3",["ly^3"],"volume",
!1,!0,8.46786664623715E-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4.16818182544058E9],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369E-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,2.365882365E-4],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828E-27],["day","d",["day"],"time",!1,!0,86400],["degree",
"\u00b0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1E-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1E-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,2.95735295625E-5],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],
["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,6.47989E-5],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1E4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,
745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],
["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1E-18],
["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,2.7777777777778E-4],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",
!1,!1,133.322],["minute","?",null,"angle",!1,!1,2.90888208665722E-4],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5E-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818E-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162E-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687E-21],["nautical mile",
"M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\u00e4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1E-4],["pica (1/6 inch)","pica",null,"length",!1,!0,3.5277777777778E-4],
["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,9.46352946E-4],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,4.84813681109536E-6],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,
!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \u00e5ngstr\u00f6m","ang2",["ang^2"],"area",!1,!0,1E-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,6.4516E-4],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189E31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],
["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1.792111111111E-5],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1E-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1E-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,1.47868E-5],["teaspoon",
"tsp",null,"volume",!1,!0,4.92892E-6],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1E3],["U.K. pint","uk_pt",null,"volume",!1,!0,5.6826125E-4],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,4.73176473E-4],["U.S. survey mile","survey_mi",null,"length",!1,!0,
1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],f={Yi:["yobi",80,1.2089258196146292E24,"Yi","yotta"],Zi:["zebi",70,1.1805916207174113E21,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,
"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},h={Y:["yotta",1E24,"Y"],Z:["zetta",1E21,"Z"],E:["exa",1E18,"E"],P:["peta",1E15,"P"],T:["tera",1E12,"T"],G:["giga",1E9,"G"],M:["mega",1E6,"M"],k:["kilo",1E3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1E-6,"u"],n:["nano",1E-9,"n"],p:["pico",1E-12,"p"],f:["femto",1E-15,"f"],
a:["atto",1E-18,"a"],z:["zepto",1E-21,"z"],y:["yocto",1E-24,"y"]},l=null,m=null,n=a,p=c,q=1,t=1,u,r=0;r<d.length;r++){u=null===d[r][2]?[]:d[r][2];if(d[r][1]===n||0<=u.indexOf(n))l=d[r];if(d[r][1]===p||0<=u.indexOf(p))m=d[r]}if(null===l)for(u=f[a.substring(0,2)],r=h[a.substring(0,1)],"da"===a.substring(0,2)&&(r=["dekao",10,"da"]),u?(q=u[2],n=a.substring(2)):r&&(q=r[1],n=a.substring(r[2].length)),a=0;a<d.length;a++)if(u=null===d[a][2]?[]:d[a][2],d[a][1]===n||0<=u.indexOf(n))l=d[a];if(null===m)for(f=
f[c.substring(0,2)],h=h[c.substring(0,1)],"da"===c.substring(0,2)&&(h=["dekao",10,"da"]),f?(t=f[2],p=c.substring(2)):h&&(t=h[1],p=c.substring(h[2].length)),c=0;c<d.length;c++)if(u=null===d[c][2]?[]:d[c][2],d[c][1]===p||0<=u.indexOf(p))m=d[c];return null===l||null===m||l[3]!==m[3]?k.na:b*l[6]*q/(m[6]*t)},DEC2BIN:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,3}$/.test(b)||-512>b||511<b)return k.num;if(0>b)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);
b=parseInt(b,10).toString(2);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DEC2HEX:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,12}$/.test(b)||-549755813888>b||549755813887<b)return k.num;if(0>b)return(1099511627776+b).toString(16);b=parseInt(b,10).toString(16);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=
b.length?REPT("0",a-b.length)+b:k.num},DEC2OCT:function(b,a){b=e.parseNumber(b);if(b instanceof Error)return b;if(!/^-?[0-9]{1,9}$/.test(b)||-536870912>b||536870911<b)return k.num;if(0>b)return(1073741824+b).toString(8);b=parseInt(b,10).toString(8);if("undefined"===typeof a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num},DELTA:function(b,a){a=void 0===a?0:a;b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:
b===a?1:0},ERF:function(b,a){}};g.ERF.PRECISE=function(){};g.ERFC=function(b){};g.ERFC.PRECISE=function(){};g.GESTEP=function(b,a){a=a||0;b=e.parseNumber(b);return e.anyIsError(a,b)?b:b>=a?1:0};g.HEX2BIN=function(b,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;var c=10===b.length&&"f"===b.substring(0,1).toLowerCase()?!0:!1;b=c?parseInt(b,16)-1099511627776:parseInt(b,16);if(-512>b||511<b)return k.num;if(c)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);c=b.toString(2);if(void 0===
a)return c;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=c.length?REPT("0",a-c.length)+c:k.num};g.HEX2DEC=function(b){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;b=parseInt(b,16);return 549755813888<=b?b-1099511627776:b};g.HEX2OCT=function(b,a){if(!/^[0-9A-Fa-f]{1,10}$/.test(b))return k.num;b=parseInt(b,16);if(536870911<b&&0xffe0000000>b)return k.num;if(0xffe0000000<=b)return(b-0xffc0000000).toString(8);b=b.toString(8);if(void 0===a)return b;if(isNaN(a))return k.value;
if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};g.IMABS=function(b){var a=g.IMREAL(b);b=g.IMAGINARY(b);return e.anyIsError(a,b)?k.value:Math.sqrt(Math.pow(a,2)+Math.pow(b,2))};g.IMAGINARY=function(b){if(void 0===b||!0===b||!1===b)return k.value;if(0===b||"0"===b)return 0;if(0<=["i","j"].indexOf(b))return 1;b=b.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var a=b.indexOf("+"),c=b.indexOf("-");0===a&&(a=b.indexOf("+",1));0===c&&
(c=b.indexOf("-",1));var d=b.substring(b.length-1,b.length);d="i"===d||"j"===d;return 0<=a||0<=c?d?0<=a?isNaN(b.substring(0,a))||isNaN(b.substring(a+1,b.length-1))?k.num:Number(b.substring(a+1,b.length-1)):isNaN(b.substring(0,c))||isNaN(b.substring(c+1,b.length-1))?k.num:-Number(b.substring(c+1,b.length-1)):k.num:d?isNaN(b.substring(0,b.length-1))?k.num:b.substring(0,b.length-1):isNaN(b)?k.num:0};g.IMARGUMENT=function(b){var a=g.IMREAL(b);b=g.IMAGINARY(b);return e.anyIsError(a,b)?k.value:0===a&&0===
b?k.div0:0===a&&0<b?Math.PI/2:0===a&&0>b?-Math.PI/2:0===b&&0<a?0:0===b&&0>a?-Math.PI:0<a?Math.atan(b/a):0>a&&0<=b?Math.atan(b/a)+Math.PI:Math.atan(b/a)-Math.PI};g.IMCONJUGATE=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;var d=b.substring(b.length-1);return 0!==c?g.COMPLEX(a,-c,"i"===d||"j"===d?d:"i"):b};g.IMCOS=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(a)*(Math.exp(c)+
Math.exp(-c))/2,-Math.sin(a)*(Math.exp(c)-Math.exp(-c))/2,"i"===b||"j"===b?b:"i")};g.IMCOSH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(c)*(Math.exp(a)+Math.exp(-a))/2,Math.sin(c)*(Math.exp(a)-Math.exp(-a))/2,"i"===b||"j"===b?b:"i")};g.IMCOT=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV(g.IMCOS(b),g.IMSIN(b))};g.IMDIV=function(b,a){var c=g.IMREAL(b),d=g.IMAGINARY(b),
f=g.IMREAL(a),h=g.IMAGINARY(a);if(e.anyIsError(c,d,f,h))return k.value;b=b.substring(b.length-1);var l=a.substring(a.length-1);a="i";"j"===b?a="j":"j"===l&&(a="j");if(0===f&&0===h)return k.num;b=f*f+h*h;return g.COMPLEX((c*f+d*h)/b,(d*f-c*h)/b,a)};g.IMEXP=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);a=Math.exp(a);return g.COMPLEX(a*Math.cos(c),a*Math.sin(c),"i"===b||"j"===b?b:"i")};g.IMLN=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);
if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+c*c)),Math.atan(c/a),"i"===b||"j"===b?b:"i")};g.IMLOG10=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*a+c*c))/Math.log(10),Math.atan(c/a)/Math.log(10),"i"===b||"j"===b?b:"i")};g.IMLOG2=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.log(Math.sqrt(a*
a+c*c))/Math.log(2),Math.atan(c/a)/Math.log(2),"i"===b||"j"===b?b:"i")};g.IMPOWER=function(b,a){a=e.parseNumber(a);var c=g.IMREAL(b),d=g.IMAGINARY(b);if(e.anyIsError(a,c,d))return k.value;c=b.substring(b.length-1);c="i"===c||"j"===c?c:"i";d=Math.pow(g.IMABS(b),a);b=g.IMARGUMENT(b);return g.COMPLEX(d*Math.cos(a*b),d*Math.sin(a*b),c)};g.IMPRODUCT=function(){for(var b=arguments[0],a=1;a<arguments.length;a++){var c=g.IMREAL(b);b=g.IMAGINARY(b);var d=g.IMREAL(arguments[a]),f=g.IMAGINARY(arguments[a]);
if(e.anyIsError(c,b,d,f))return k.value;b=g.COMPLEX(c*d-b*f,c*f+b*d)}return b};g.IMREAL=function(b){if(void 0===b||!0===b||!1===b)return k.value;if(0===b||"0"===b||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(b))return 0;var a=b.indexOf("+"),c=b.indexOf("-");0===a&&(a=b.indexOf("+",1));0===c&&(c=b.indexOf("-",1));var d=b.substring(b.length-1,b.length);d="i"===d||"j"===d;return 0<=a||0<=c?d?0<=a?isNaN(b.substring(0,a))||isNaN(b.substring(a+1,b.length-1))?k.num:Number(b.substring(0,
a)):isNaN(b.substring(0,c))||isNaN(b.substring(c+1,b.length-1))?k.num:Number(b.substring(0,c)):k.num:d?isNaN(b.substring(0,b.length-1))?k.num:0:isNaN(b)?k.num:b};g.IMSEC=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV("1",g.IMCOS(b))};g.IMSECH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.value:g.IMDIV("1",g.IMCOSH(b))};g.IMSIN=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;
b=b.substring(b.length-1);return g.COMPLEX(Math.sin(a)*(Math.exp(c)+Math.exp(-c))/2,Math.cos(a)*(Math.exp(c)-Math.exp(-c))/2,"i"===b||"j"===b?b:"i")};g.IMSINH=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;b=b.substring(b.length-1);return g.COMPLEX(Math.cos(c)*(Math.exp(a)-Math.exp(-a))/2,Math.sin(c)*(Math.exp(a)+Math.exp(-a))/2,"i"===b||"j"===b?b:"i")};g.IMSQRT=function(b){var a=g.IMREAL(b),c=g.IMAGINARY(b);if(e.anyIsError(a,c))return k.value;a=b.substring(b.length-
1);a="i"===a||"j"===a?a:"i";c=Math.sqrt(g.IMABS(b));b=g.IMARGUMENT(b);return g.COMPLEX(c*Math.cos(b/2),c*Math.sin(b/2),a)};g.IMCSC=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.num:g.IMDIV("1",g.IMSIN(b))};g.IMCSCH=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,c)?k.num:g.IMDIV("1",g.IMSINH(b))};g.IMSUB=function(b,a){var c=this.IMREAL(b),d=this.IMAGINARY(b),f=this.IMREAL(a),h=this.IMAGINARY(a);
if(e.anyIsError(c,d,f,h))return k.value;b=b.substring(b.length-1);a=a.substring(a.length-1);var l="i";"j"===b?l="j":"j"===a&&(l="j");return this.COMPLEX(c-f,d-h,l)};g.IMSUM=function(){for(var b=e.flatten(arguments),a=b[0],c=1;c<b.length;c++){var d=this.IMREAL(a);a=this.IMAGINARY(a);var f=this.IMREAL(b[c]),h=this.IMAGINARY(b[c]);if(e.anyIsError(d,a,f,h))return k.value;a=this.COMPLEX(d+f,a+h)}return a};g.IMTAN=function(b){if(!0===b||!1===b)return k.value;var a=g.IMREAL(b),c=g.IMAGINARY(b);return e.anyIsError(a,
c)?k.value:this.IMDIV(this.IMSIN(b),this.IMCOS(b))};g.OCT2BIN=function(b,a){if(!/^[0-7]{1,10}$/.test(b))return k.num;var c=10===b.length&&"7"===b.substring(0,1)?!0:!1;b=c?parseInt(b,8)-1073741824:parseInt(b,8);if(-512>b||511<b)return k.num;if(c)return"1"+REPT("0",9-(512+b).toString(2).length)+(512+b).toString(2);c=b.toString(2);if("undefined"===typeof a)return c;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=c.length?REPT("0",a-c.length)+c:k.num};g.OCT2DEC=function(b){if(!/^[0-7]{1,10}$/.test(b))return k.num;
b=parseInt(b,8);return 536870912<=b?b-1073741824:b};g.OCT2HEX=function(b,a){if(!/^[0-7]{1,10}$/.test(b))return k.num;b=parseInt(b,8);if(536870912<=b)return"ff"+(b+3221225472).toString(16);b=b.toString(16);if(void 0===a)return b;if(isNaN(a))return k.value;if(0>a)return k.num;a=Math.floor(a);return a>=b.length?REPT("0",a-b.length)+b:k.num};return g}();y.financial=function(){function g(c){return c&&c.getTime&&!isNaN(c.getTime())}function b(c){return c instanceof Date?c:new Date(c)}var a={ACCRINT:function(c,
d,f,h,l,m,n){c=b(c);d=b(d);f=b(f);return g(c)&&g(d)&&g(f)?0>=h||0>=l||-1===[1,2,4].indexOf(m)||-1===[0,1,2,3,4].indexOf(n)||f<=c?"#NUM!":(l||0)*h*YEARFRAC(c,f,n||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(c,d,f,h,l,m){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;if(0>=c||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(c,d,
f,0,m);var n=0;1===h&&0===m&&(n=-f,h++);for(;h<=l;h++)n=1===m?n+(a.FV(c,h-2,d,f,1)-d):n+a.FV(c,h-1,d,f,0);return n*c},CUMPRINC:function(c,d,f,h,l,m){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;if(0>=c||0>=d||0>=f||1>h||1>l||h>l||0!==m&&1!==m)return k.num;d=a.PMT(c,d,f,0,m);var n=0;1===h&&(n=0===m?d+f*c:d,h++);for(;h<=l;h++)n=0<m?n+(d-(a.FV(c,h-2,d,f,1)-d)*c):n+(d-a.FV(c,h-1,d,f,0)*c);return n},DB:function(c,d,f,h,l){l=void 0===l?12:l;c=e.parseNumber(c);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;if(0>c||0>d||0>f||0>h||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(l)||h>f)return k.num;if(d>=c)return 0;d=(1-Math.pow(d/c,1/f)).toFixed(3);for(var m=l=c*d*l/12,n=0,p=h===f?f-1:h,q=2;q<=p;q++)n=(c-m)*d,m+=n;return 1===h?l:h===f?(c-m)*d:n},DDB:function(c,d,f,h,l){l=void 0===l?2:l;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,
d,f,h,l))return k.value;if(0>c||0>d||0>f||0>h||0>=l||h>f)return k.num;if(d>=c)return 0;for(var m=0,n=0,p=1;p<=h;p++)n=Math.min(l/f*(c-m),c-d-m),m+=n;return n},DISC:null,DOLLARDE:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(c,10);f+=c%1*Math.pow(10,Math.ceil(Math.log(d)/Math.LN10))/d;c=Math.pow(10,Math.ceil(Math.log(d)/Math.LN2)+1);return f=Math.round(f*c)/c},DOLLARFR:function(c,
d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>d)return k.num;if(0<=d&&1>d)return k.div0;d=parseInt(d,10);var f=parseInt(c,10);return f+=c%1*Math.pow(10,-Math.ceil(Math.log(d)/Math.LN10))*d},DURATION:null,EFFECT:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>=c||1>d)return k.num;d=parseInt(d,10);return Math.pow(1+c/d,d)-1},FV:function(c,d,f,h,l){h=h||0;l=l||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=
e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;0===c?c=h+f*d:(d=Math.pow(1+c,d),c=1===l?h*d+f*(1+c)*(d-1)/c:h*d+f*(d-1)/c);return-c},FVSCHEDULE:function(c,d){c=e.parseNumber(c);d=e.parseNumberArray(e.flatten(d));if(e.anyIsError(c,d))return k.value;for(var f=d.length,h=0;h<f;h++)c*=1+d[h];return c},INTRATE:null,IPMT:function(c,d,f,h,l,m){l=l||0;m=m||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);if(e.anyIsError(c,
d,f,h,l,m))return k.value;f=a.PMT(c,f,h,l,m);return(1===d?1===m?0:-h:1===m?a.FV(c,d-2,f,h,1)-f:a.FV(c,d-1,f,h,0))*c},IRR:function(c,d){d=d||0;c=e.parseNumberArray(e.flatten(c));d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;for(var f=function(q,t,u){u+=1;for(var r=q[0],v=1;v<q.length;v++)r+=q[v]/Math.pow(u,(t[v]-t[0])/365);return r},h=function(q,t,u){u+=1;for(var r=0,v=1;v<q.length;v++){var E=(t[v]-t[0])/365;r-=E*q[v]/Math.pow(u,E+1)}return r},l=[],m=!1,n=!1,p=0;p<c.length;p++)l[p]=0===p?
0:l[p-1]+365,0<c[p]&&(m=!0),0>c[p]&&(n=!0);if(!m||!n)return k.num;d=void 0===d?.1:d;m=!0;do p=f(c,l,d),m=d-p/h(c,l,d),n=Math.abs(m-d),d=m,m=1E-10<n&&1E-10<Math.abs(p);while(m);return d},ISPMT:function(c,d,f,h){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);return e.anyIsError(c,d,f,h)?k.value:h*c*(d/f-1)},MDURATION:null,MIRR:function(c,d,f){c=e.parseNumberArray(e.flatten(c));d=e.parseNumber(d);f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;for(var h=c.length,
l=[],m=[],n=0;n<h;n++)0>c[n]?l.push(c[n]):m.push(c[n]);c=-a.NPV(f,m)*Math.pow(1+f,h-1);d=a.NPV(d,l)*(1+d);return Math.pow(c/d,1/(h-1))-1},NOMINAL:function(c,d){c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(c,d))return k.value;if(0>=c||1>d)return k.num;d=parseInt(d,10);return(Math.pow(c+1,1/d)-1)*d},NPER:function(c,d,f,h,l){l=void 0===l?0:l;h=void 0===h?0:h;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(c,d,f,h,l)?k.value:
Math.log((d*(1+c*l)-h*c)/(f*c+d*(1+c*l)))/Math.log(1+c)},NPV:function(){var c=e.parseNumberArray(e.flatten(arguments));if(c instanceof Error)return c;for(var d=c[0],f=0,h=1;h<c.length;h++)f+=c[h]/Math.pow(1+d,h);return f},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=c?k.num:(Math.log(f)-Math.log(d))/Math.log(1+c)},PMT:function(c,d,f,h,l){h=h||0;l=l||0;c=e.parseNumber(c);
d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);if(e.anyIsError(c,d,f,h,l))return k.value;0===c?c=(f+h)/d:(d=Math.pow(1+c,d),c=1===l?(h*c/(d-1)+f*c/(1-1/d))/(1+c):h*c/(d-1)+f*c/(1-1/d));return-c},PPMT:function(c,d,f,h,l,m){l=l||0;m=m||0;c=e.parseNumber(c);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);return e.anyIsError(c,f,h,l,m)?k.value:a.PMT(c,f,h,l,m)-a.IPMT(c,d,f,h,l,m)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(c,d,f,h,l){h=
h||0;l=l||0;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);return e.anyIsError(c,d,f,h,l)?k.value:0===c?-f*d-h:((1-Math.pow(1+c,d))/c*f*(1+c*l)-h)/Math.pow(1+c,d)},RATE:function(c,d,f,h,l,m){m=void 0===m?.01:m;h=void 0===h?0:h;l=void 0===l?0:l;c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);l=e.parseNumber(l);m=e.parseNumber(m);if(e.anyIsError(c,d,f,h,l,m))return k.value;for(var n=0,p=!1;100>n&&!p;){var q=Math.pow(m+1,c),
t=Math.pow(m+1,c-1);q=m-(h+q*f+d*(q-1)*(m*l+1)/m)/(c*t*f-d*(q-1)*(m*l+1)/Math.pow(m,2)+(c*d*t*(m*l+1)/m+d*(q-1)*l/m));1E-6>Math.abs(q-m)&&(p=!0);n++;m=q}return p?m:Number.NaN+m},RECEIVED:null,RRI:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0===c||0===d?k.num:Math.pow(f/d,1/c)-1},SLN:function(c,d,f){c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0===f?k.num:(c-d)/f},SYD:function(c,d,f,h){c=
e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumber(f);h=e.parseNumber(h);if(e.anyIsError(c,d,f,h))return k.value;if(0===f||1>h||h>f)return k.num;h=parseInt(h,10);return(c-d)*(f-h+1)*2/(f*(f+1))},TBILLEQ:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<d-c?k.num:365*f/(360-f*DAYS360(c,d,!1))},TBILLPRICE:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<
d-c?k.num:100*(1-f*DAYS360(c,d,!1)/360)},TBILLYIELD:function(c,d,f){c=e.parseDate(c);d=e.parseDate(d);f=e.parseNumber(f);return e.anyIsError(c,d,f)?k.value:0>=f||c>d||31536E6<d-c?k.num:360*(100-f)/(f*DAYS360(c,d,!1))},VDB:null,XIRR:function(c,d,f){c=e.parseNumberArray(e.flatten(c));d=e.parseDateArray(e.flatten(d));f=e.parseNumber(f);if(e.anyIsError(c,d,f))return k.value;for(var h=function(q,t,u){u+=1;for(var r=q[0],v=1;v<q.length;v++)r+=q[v]/Math.pow(u,DAYS(t[v],t[0])/365);return r},l=function(q,
t,u){u+=1;for(var r=0,v=1;v<q.length;v++){var E=DAYS(t[v],t[0])/365;r-=E*q[v]/Math.pow(u,E+1)}return r},m=!1,n=!1,p=0;p<c.length;p++)0<c[p]&&(m=!0),0>c[p]&&(n=!0);if(!m||!n)return k.num;f=f||.1;m=!0;do p=h(c,d,f),m=f-p/l(c,d,f),n=Math.abs(m-f),f=m,m=1E-10<n&&1E-10<Math.abs(p);while(m);return f},XNPV:function(c,d,f){c=e.parseNumber(c);d=e.parseNumberArray(e.flatten(d));f=e.parseDateArray(e.flatten(f));if(e.anyIsError(c,d,f))return k.value;for(var h=0,l=0;l<d.length;l++)h+=d[l]/Math.pow(1+c,DAYS(f[l],
f[0])/365);return h},YIELD:null,YIELDDISC:null,YIELDMAT:null};return a}();y.information=function(){var g={CELL:null,ERROR:{}};g.ERROR.TYPE=function(b){switch(b){case k.nil:return 1;case k.div0:return 2;case k.value:return 3;case k.ref:return 4;case k.name:return 5;case k.num:return 6;case k.na:return 7;case k.data:return 8}return k.na};g.INFO=null;g.ISBLANK=function(b){return null===b||void 0===b||""===b};g.ISBINARY=function(b){return/^[01]{1,10}$/.test(b)};g.ISERR=function(b){return 0<=[k.value,
k.ref,k.div0,k.num,k.name,k.nil].indexOf(b)||"number"===typeof b&&(isNaN(b)||!isFinite(b))};g.ISERROR=function(b){return g.ISERR(b)||b===k.na};g.ISEVEN=function(b){return Math.floor(Math.abs(b))&1?!1:!0};g.ISFORMULA=null;g.ISLOGICAL=function(b){return!0===b||!1===b};g.ISNA=function(b){return b===k.na};g.ISNONTEXT=function(b){return"string"!==typeof b};g.ISNUMBER=function(b){return"number"===typeof b&&!isNaN(b)&&isFinite(b)};g.ISODD=function(b){return Math.floor(Math.abs(b))&1?!0:!1};g.ISREF=null;
g.ISTEXT=function(b){return"string"===typeof b};g.N=function(b){return this.ISNUMBER(b)?b:b instanceof Date?b.getTime():!0===b?1:!1===b?0:this.ISERROR(b)?b:0};g.NA=function(){return k.na};g.SHEET=null;g.SHEETS=null;g.TYPE=function(b){if(this.ISNUMBER(b))return 1;if(this.ISTEXT(b))return 2;if(this.ISLOGICAL(b))return 4;if(this.ISERROR(b))return 16;if(Array.isArray(b))return 64};return g}();y.logical=function(){return{AND:function(){for(var g=e.flatten(arguments),b=!0,a=0;a<g.length;a++)g[a]||(b=!1);
return b},CHOOSE:function(){if(2>arguments.length)return k.na;var g=arguments[0];return 1>g||254<g||arguments.length<g+1?k.value:arguments[g]},FALSE:function(){return!1},IF:function(g,b,a){return g?b:a},IFERROR:function(g,b){return ISERROR(g)?b:g},IFNA:function(g,b){return g===k.na?b:g},NOT:function(g){return!g},OR:function(){for(var g=e.flatten(arguments),b=!1,a=0;a<g.length;a++)g[a]&&(b=!0);return b},TRUE:function(){return!0},XOR:function(){for(var g=e.flatten(arguments),b=0,a=0;a<g.length;a++)g[a]&&
b++;return Math.floor(Math.abs(b))&1?!0:!1},SWITCH:function(){if(0<arguments.length){var g=arguments[0],b=arguments.length-1,a=Math.floor(b/2),c=!1;b=0===b%2?null:arguments[arguments.length-1];if(a)for(var d=0;d<a;d++)if(g===arguments[2*d+1]){var f=arguments[2*d+2];c=!0;break}!c&&b&&(f=b)}return f}}}();y.math=function(){var g={ABS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.abs(e.parseNumber(a))},ACOS:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.acos(a)},ACOSH:function(a){a=
e.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a-1))},ACOT:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(1/a)},ACOTH:function(a){a=e.parseNumber(a);return a instanceof Error?a:.5*Math.log((a+1)/(a-1))},AGGREGATE:null,ARABIC:function(a){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(a))return k.value;var c=0;a.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(d){c+={M:1E3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,
I:1}[d]});return c},ASIN:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.asin(a)},ASINH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a+Math.sqrt(a*a+1))},ATAN:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.atan(a)},ATAN2:function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.atan2(a,c)},ATANH:function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log((1+a)/(1-a))/2},BASE:function(a,c,d){d=d||0;a=e.parseNumber(a);
c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;d=void 0===d?0:d;a=a.toString(c);return Array(Math.max(d+1-a.length,0)).join("0")+a},CEILING:function(a,c,d){c=void 0===c?1:c;d=void 0===d?0:d;a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;if(0===c)return 0;c=Math.abs(c);return 0<=a?Math.ceil(a/c)*c:0===d?-1*Math.floor(Math.abs(a)/c)*c:-1*Math.ceil(Math.abs(a)/c)*c}};g.CEILING.MATH=g.CEILING;g.CEILING.PRECISE=g.CEILING;g.COMBIN=
function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:g.FACT(a)/(g.FACT(c)*g.FACT(a-c))};g.COMBINA=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0===a&&0===c?1:g.COMBIN(a+c-1,a-1)};g.COS=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.cos(a)};g.COSH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)+Math.exp(-a))/2};g.COT=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.tan(a)};
g.COTH=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a+1)/(a-1)};g.CSC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.sin(a)};g.CSCH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)-Math.exp(-a))};g.DECIMAL=function(a,c){return 1>arguments.length?k.value:parseInt(a,c)};g.DEGREES=function(a){a=e.parseNumber(a);return a instanceof Error?a:180*a/Math.PI};g.EVEN=function(a){a=e.parseNumber(a);return a instanceof Error?
a:g.CEILING(a,-2,-1)};g.EXP=Math.exp;var b=[];g.FACT=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);if(0===a||1===a)return 1;0<b[a]||(b[a]=g.FACT(a-1)*a);return b[a]};g.FACTDOUBLE=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.floor(a);return 0>=a?1:a*g.FACTDOUBLE(a-2)};g.FLOOR=function(a,c,d){c=void 0===c?1:c;d=void 0===d?0:d;a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(a,c,d))return k.value;if(0===c)return 0;c=Math.abs(c);
return 0<=a?Math.floor(a/c)*c:0===d?-1*Math.ceil(Math.abs(a)/c)*c:-1*Math.floor(Math.abs(a)/c)*c};g.FLOOR.MATH=g.FLOOR;g.GCD=null;g.INT=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.floor(a)};g.LCM=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c,d,f,h=1;void 0!==(f=a.pop());)for(;1<f;){if(f%2){c=3;for(d=Math.floor(Math.sqrt(f));c<=d&&f%c;c+=2);d=c<=d?c:f}else d=2;f/=d;h*=d;for(c=a.length;c;0===a[--c]%d&&1===(a[c]/=d)&&a.splice(c,
1));}return h};g.LN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.log(a)};g.LOG=function(a,c){a=e.parseNumber(a);c=void 0===c?10:e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.log(a)/Math.log(c)};g.LOG10=function(a){a=e.parseNumber(a);return a instanceof Error?a:0===a?k.num:Math.log(a)/Math.log(10)};g.MDETERM=null;g.MINVERSE=null;g.MMULT=null;g.MOD=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c))return k.value;if(0===c)return k.div0;a=Math.abs(a%
c);return 0<c?a:-a};g.MROUND=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0>a*c?k.num:Math.round(a/c)*c};g.MULTINOMIAL=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c=0,d=1,f=0;f<a.length;f++)c+=a[f],d*=g.FACT(a[f]);return g.FACT(c)/d};g.MUNIT=null;g.ODD=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;var c=Math.ceil(Math.abs(a));c=c&1?c:c+1;return 0<a?c:-c};g.PI=function(){return Math.PI};g.POWER=
function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c))return k.value;a=Math.pow(a,c);return isNaN(a)?k.num:a};g.PRODUCT=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;for(var c=1,d=0;d<a.length;d++)c*=a[d];return c};g.QUOTIENT=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:parseInt(a/c,10)};g.RADIANS=function(a){a=e.parseNumber(a);return a instanceof Error?a:a*Math.PI/180};g.RAND=function(){return Math.random()};
g.RANDBETWEEN=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a+Math.ceil((c-a+1)*Math.random())-1};g.ROMAN=null;g.ROUND=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:Math.round(a*Math.pow(10,c))/Math.pow(10,c)};g.ROUNDDOWN=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};g.ROUNDUP=function(a,c){a=e.parseNumber(a);c=e.parseNumber(c);
return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.ceil(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};g.SEC=function(a){a=e.parseNumber(a);return a instanceof Error?a:1/Math.cos(a)};g.SECH=function(a){a=e.parseNumber(a);return a instanceof Error?a:2/(Math.exp(a)+Math.exp(-a))};g.SERIESSUM=function(a,c,d,f){a=e.parseNumber(a);c=e.parseNumber(c);d=e.parseNumber(d);f=e.parseNumberArray(f);if(e.anyIsError(a,c,d,f))return k.value;for(var h=f[0]*Math.pow(a,c),l=1;l<f.length;l++)h+=f[l]*Math.pow(a,c+l*d);return h};
g.SIGN=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?-1:0===a?0:1};g.SIN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sin(a)};g.SINH=function(a){a=e.parseNumber(a);return a instanceof Error?a:(Math.exp(a)-Math.exp(-a))/2};g.SQRT=function(a){a=e.parseNumber(a);return a instanceof Error?a:0>a?k.num:Math.sqrt(a)};g.SQRTPI=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.sqrt(a*Math.PI)};g.SUBTOTAL=null;g.ADD=function(a,c){if(2!==arguments.length)return k.na;
a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a+c};g.MINUS=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a-c};g.DIVIDE=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:0===c?k.div0:a/c};g.MULTIPLY=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.value:a*c};g.GTE=
function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a>=c};g.LT=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a<c};g.LTE=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:a<=c};g.EQ=function(a,c){return 2!==arguments.length?k.na:a===c};g.NE=function(a,c){return 2!==arguments.length?k.na:
a!==c};g.POW=function(a,c){if(2!==arguments.length)return k.na;a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(a,c)?k.error:g.POWER(a,c)};g.SUM=function(){for(var a=0,c=Object.keys(arguments),d=0;d<c.length;++d){var f=arguments[c[d]];"number"===typeof f?a+=f:"string"===typeof f?(f=parseFloat(f),!isNaN(f)&&(a+=f)):Array.isArray(f)&&(a+=g.SUM.apply(null,f))}return a};g.SUMIF=function(){var a=e.argsToArray(arguments),c=a.pop();a=e.parseNumberArray(e.flatten(a));if(a instanceof Error)return a;
for(var d=0,f=0;f<a.length;f++)d+=eval(a[f]+c)?a[f]:0;return d};g.SUMIFS=function(){var a=e.argsToArray(arguments),c=e.parseNumberArray(e.flatten(a.shift()));if(c instanceof Error)return c;for(var d=c.length,f=a.length,h=0,l=0;l<d;l++){for(var m=c[l],n="",p=0;p<f;p+=2)n=isNaN(a[p][l])?n+('"'+a[p][l]+'"'+a[p+1]):n+(a[p][l]+a[p+1]),p!==f-1&&(n+=" && ");n=n.slice(0,-4);eval(n)&&(h+=m)}return h};g.SUMPRODUCT=null;g.SUMSQ=function(){var a=e.parseNumberArray(e.flatten(arguments));if(a instanceof Error)return a;
for(var c=0,d=a.length,f=0;f<d;f++)c+=ISNUMBER(a[f])?a[f]*a[f]:0;return c};g.SUMX2MY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;for(var d=0,f=0;f<a.length;f++)d+=a[f]*a[f]-c[f]*c[f];return d};g.SUMX2PY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;var d=0;a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));for(var f=0;f<a.length;f++)d+=
a[f]*a[f]+c[f]*c[f];return d};g.SUMXMY2=function(a,c){a=e.parseNumberArray(e.flatten(a));c=e.parseNumberArray(e.flatten(c));if(e.anyIsError(a,c))return k.value;var d=0;a=e.flatten(a);c=e.flatten(c);for(var f=0;f<a.length;f++)d+=Math.pow(a[f]-c[f],2);return d};g.TAN=function(a){a=e.parseNumber(a);return a instanceof Error?a:Math.tan(a)};g.TANH=function(a){a=e.parseNumber(a);if(a instanceof Error)return a;a=Math.exp(2*a);return(a-1)/(a+1)};g.TRUNC=function(a,c){c=void 0===c?0:c;a=e.parseNumber(a);c=
e.parseNumber(c);return e.anyIsError(a,c)?k.value:(0<a?1:-1)*Math.floor(Math.abs(a)*Math.pow(10,c))/Math.pow(10,c)};return g}();y.misc=function(){var g={UNIQUE:function(){for(var b=[],a=0;a<arguments.length;++a){for(var c=!1,d=arguments[a],f=0;f<b.length&&!(c=b[f]===d);++f);c||b.push(d)}return b}};g.FLATTEN=e.flatten;g.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};g.REFERENCE=function(b,a){try{var c=a.split(".");for(a=0;a<c.length;++a){var d=c[a];if("]"===d[d.length-1]){var f=
d.indexOf("["),h=d.substring(f+1,d.length-1);b=b[d.substring(0,f)][h]}else b=b[d]}return b}catch(l){}};g.JOIN=function(b,a){return b.join(a)};g.NUMBERS=function(){return e.flatten(arguments).filter(function(b){return"number"===typeof b})};g.NUMERAL=null;return g}();y.text=function(){var g={ASC:null,BAHTTEXT:null,CHAR:function(b){b=e.parseNumber(b);return b instanceof Error?b:String.fromCharCode(b)},CLEAN:function(b){return(b||"").replace(/[\0-\x1F]/g,"")},CODE:function(b){return(b||"").charCodeAt(0)},
CONCATENATE:function(){for(var b=e.flatten(arguments),a;-1<(a=b.indexOf(!0));)b[a]="TRUE";for(;-1<(a=b.indexOf(!1));)b[a]="FALSE";return b.join("")},DBCS:null,DOLLAR:null,EXACT:function(b,a){return b===a},FIND:function(b,a,c){return a?a.indexOf(b,(void 0===c?0:c)-1)+1:null},FIXED:null,HTML2TEXT:function(b){var a="";b&&(b instanceof Array?b.forEach(function(c){""!==a&&(a+="\n");a+=c.replace(/<(?:.|\n)*?>/gm,"")}):a=b.replace(/<(?:.|\n)*?>/gm,""));return a},LEFT:function(b,a){a=e.parseNumber(void 0===
a?1:a);return a instanceof Error||"string"!==typeof b?k.value:b?b.substring(0,a):null},LEN:function(b){return 0===arguments.length?k.error:"string"===typeof b?b?b.length:0:b.length?b.length:k.value},LOWER:function(b){return"string"!==typeof b?k.value:b?b.toLowerCase():b},MID:function(b,a,c){a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(a,c)||"string"!==typeof b)return c;--a;return b.substring(a,a+c)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(b){if(void 0===b||0===b.length)return k.value;
!0===b&&(b="TRUE");!1===b&&(b="FALSE");if(isNaN(b)&&"number"===typeof b)return k.value;"number"===typeof b&&(b=""+b);return b.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},REGEXEXTRACT:function(b,a){return(b=b.match(new RegExp(a)))?b[1<b.length?b.length-1:0]:null},REGEXMATCH:function(b,a,c){b=b.match(new RegExp(a));return c?b:!!b},REGEXREPLACE:function(b,a,c){return b.replace(new RegExp(a),c)},REPLACE:function(b,a,c,d){a=e.parseNumber(a);c=e.parseNumber(c);
return e.anyIsError(a,c)||"string"!==typeof b||"string"!==typeof d?k.value:b.substr(0,a-1)+d+b.substr(a-1+c)},REPT:function(b,a){a=e.parseNumber(a);return a instanceof Error?a:Array(a+1).join(b)},RIGHT:function(b,a){a=e.parseNumber(void 0===a?1:a);return a instanceof Error?a:b?b.substring(b.length-a):null},SEARCH:function(b,a,c){if("string"!==typeof b||"string"!==typeof a)return k.value;c=void 0===c?0:c;b=a.toLowerCase().indexOf(b.toLowerCase(),c-1)+1;return 0===b?k.value:b},SPLIT:function(b,a){return b.split(a)},
SUBSTITUTE:function(b,a,c,d){if(b&&a&&c){if(void 0===d)return b.replace(new RegExp(a,"g"),c);for(var f=0,h=0;0<b.indexOf(a,f);)if(f=b.indexOf(a,f+1),h++,h===d)return b.substring(0,f)+c+b.substring(f+a.length)}else return b},T:function(b){return"string"===typeof b?b:""},TEXT:null,TRIM:function(b){return"string"!==typeof b?k.value:b.replace(/ +/g," ").trim()}};g.UNICHAR=g.CHAR;g.UNICODE=g.CODE;g.UPPER=function(b){return"string"!==typeof b?k.value:b.toUpperCase()};g.VALUE=null;return g}();y.stats=function(){var g=
{AVEDEV:null,AVERAGE:function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=0,f=0;f<a;f++)c+=b[f],d+=1;return c/d},AVERAGEA:function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=0;f<a;f++){var h=b[f];"number"===typeof h&&(c+=h);!0===h&&c++;null!==h&&d++}return c/d},AVERAGEIF:function(b,a,c){c=c||b;b=e.flatten(b);c=e.parseNumberArray(e.flatten(c));if(c instanceof Error)return c;for(var d=0,f=0,h=0;h<b.length;h++)eval(b[h]+a)&&(f+=c[h],d++);return f/d},AVERAGEIFS:null,COUNT:function(){return e.numbers(e.flatten(arguments)).length},
COUNTA:function(){var b=e.flatten(arguments);return b.length-g.COUNTBLANK(b)},COUNTIN:function(b,a){for(var c=0,d=0;d<b.length;d++)b[d]===a&&c++;return c},COUNTBLANK:function(){for(var b=e.flatten(arguments),a=0,c,d=0;d<b.length;d++)c=b[d],null!==c&&""!==c||a++;return a},COUNTIF:function(){var b=e.argsToArray(arguments),a=b.pop();b=e.flatten(b);/[<>=!]/.test(a)||(a='=="'+a+'"');for(var c=0,d=0;d<b.length;d++)"string"!==typeof b[d]?eval(b[d]+a)&&c++:eval('"'+b[d]+'"'+a)&&c++;return c},COUNTIFS:function(){for(var b=
e.argsToArray(arguments),a=Array(e.flatten(b[0]).length),c=0;c<a.length;c++)a[c]=!0;for(c=0;c<b.length;c+=2){var d=e.flatten(b[c]),f=b[c+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var h=0;h<d.length;h++)a[h]="string"!==typeof d[h]?a[h]&&eval(d[h]+f):a[h]&&eval('"'+d[h]+'"'+f)}for(c=b=0;c<a.length;c++)a[c]&&b++;return b},COUNTUNIQUE:function(){return UNIQUE.apply(null,e.flatten(arguments)).length},FISHER:function(b){b=e.parseNumber(b);return b instanceof Error?b:Math.log((1+b)/(1-b))/2},FISHERINV:function(b){b=
e.parseNumber(b);if(b instanceof Error)return b;b=Math.exp(2*b);return(b-1)/(b+1)},FREQUENCY:function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;for(var c=b.length,d=a.length,f=[],h=0;h<=d;h++)for(var l=f[h]=0;l<c;l++)0===h?b[l]<=a[0]&&(f[0]+=1):h<d?b[l]>a[h-1]&&b[l]<=a[h]&&(f[h]+=1):h===d&&b[l]>a[d-1]&&(f[d]+=1);return f},LARGE:function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);return e.anyIsError(b,a)?b:b.sort(function(c,
d){return d-c})[a-1]},MAX:function(){var b=e.numbers(e.flatten(arguments));return 0===b.length?0:Math.max.apply(Math,b)},MAXA:function(){var b=e.arrayValuesToNumbers(e.flatten(arguments));return 0===b.length?0:Math.max.apply(Math,b)},MIN:function(){var b=e.numbers(e.flatten(arguments));return 0===b.length?0:Math.min.apply(Math,b)},MINA:function(){var b=e.arrayValuesToNumbers(e.flatten(arguments));return 0===b.length?0:Math.min.apply(Math,b)},MODE:{}};g.MODE.MULT=function(){var b=e.parseNumberArray(e.flatten(arguments));
if(b instanceof Error)return b;for(var a=b.length,c={},d=[],f=0,h,l=0;l<a;l++)h=b[l],c[h]=c[h]?c[h]+1:1,c[h]>f&&(f=c[h],d=[]),c[h]===f&&(d[d.length]=h);return d};g.MODE.SNGL=function(){var b=e.parseNumberArray(e.flatten(arguments));return b instanceof Error?b:g.MODE.MULT(b).sort(function(a,c){return a-c})[0]};g.PERCENTILE={};g.PERCENTILE.EXC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;b=b.sort(function(d,f){return d-f});var c=b.length;if(a<
1/(c+1)||a>1-1/(c+1))return k.num;a=a*(c+1)-1;c=Math.floor(a);return e.cleanFloat(a===c?b[a]:b[c]+(a-c)*(b[c+1]-b[c]))};g.PERCENTILE.INC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;b=b.sort(function(d,f){return d-f});a*=b.length-1;var c=Math.floor(a);return e.cleanFloat(a===c?b[a]:b[c]+(a-c)*(b[c+1]-b[c]))};g.PERCENTRANK={};g.PERCENTRANK.EXC=function(b,a,c){c=void 0===c?3:c;b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);c=e.parseNumber(c);
if(e.anyIsError(b,a,c))return k.value;b=b.sort(function(p,q){return p-q});var d=UNIQUE.apply(null,b),f=b.length,h=d.length;c=Math.pow(10,c);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=(b.indexOf(d[n])+1)/(f+1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(b.indexOf(d[n])+1+(a-d[n])/(d[n+1]-d[n]))/(f+1),m=!0),n++;return Math.floor(l*c)/c};g.PERCENTRANK.INC=function(b,a,c){c=void 0===c?3:c;b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);c=e.parseNumber(c);if(e.anyIsError(b,a,c))return k.value;b=b.sort(function(p,
q){return p-q});var d=UNIQUE.apply(null,b),f=b.length,h=d.length;c=Math.pow(10,c);for(var l=0,m=!1,n=0;!m&&n<h;)a===d[n]?(l=b.indexOf(d[n])/(f-1),m=!0):a>=d[n]&&(a<d[n+1]||n===h-1)&&(l=(b.indexOf(d[n])+(a-d[n])/(d[n+1]-d[n]))/(f-1),m=!0),n++;return Math.floor(l*c)/c};g.PERMUT=function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:FACT(b)/FACT(b-a)};g.PERMUTATIONA=function(b,a){b=e.parseNumber(b);a=e.parseNumber(a);return e.anyIsError(b,a)?k.value:Math.pow(b,a)};g.PHI=
function(b){b=e.parseNumber(b);return b instanceof Error?k.value:Math.exp(-.5*b*b)/2.5066282746310002};g.PROB=function(b,a,c,d){if(void 0===c)return 0;d=void 0===d?c:d;b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));c=e.parseNumber(c);d=e.parseNumber(d);if(e.anyIsError(b,a,c,d))return k.value;if(c===d)return 0<=b.indexOf(c)?a[b.indexOf(c)]:0;for(var f=b.sort(function(n,p){return n-p}),h=f.length,l=0,m=0;m<h;m++)f[m]>=c&&f[m]<=d&&(l+=a[b.indexOf(f[m])]);return l};g.QUARTILE={};
g.QUARTILE.EXC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;switch(a){case 1:return g.PERCENTILE.EXC(b,.25);case 2:return g.PERCENTILE.EXC(b,.5);case 3:return g.PERCENTILE.EXC(b,.75);default:return k.num}};g.QUARTILE.INC=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;switch(a){case 1:return g.PERCENTILE.INC(b,.25);case 2:return g.PERCENTILE.INC(b,.5);case 3:return g.PERCENTILE.INC(b,
.75);default:return k.num}};g.RANK={};g.RANK.AVG=function(b,a,c){b=e.parseNumber(b);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;a=e.flatten(a);a=a.sort(c?function(h,l){return h-l}:function(h,l){return l-h});c=a.length;for(var d=0,f=0;f<c;f++)a[f]===b&&d++;return 1<d?(2*a.indexOf(b)+d+1)/2:a.indexOf(b)+1};g.RANK.EQ=function(b,a,c){b=e.parseNumber(b);a=e.parseNumberArray(e.flatten(a));if(e.anyIsError(b,a))return k.value;a=a.sort(c?function(d,f){return d-f}:function(d,f){return f-
d});return a.indexOf(b)+1};g.RSQ=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumberArray(e.flatten(a));return e.anyIsError(b,a)?k.value:Math.pow(g.PEARSON(b,a),2)};g.SMALL=function(b,a){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);return e.anyIsError(b,a)?b:b.sort(function(c,d){return c-d})[a-1]};g.STANDARDIZE=function(b,a,c){b=e.parseNumber(b);a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(b,a,c)?k.value:(b-a)/c};g.STDEV={};g.STDEV.P=function(){var b=g.VAR.P.apply(this,
arguments);return Math.sqrt(b)};g.STDEV.S=function(){var b=g.VAR.S.apply(this,arguments);return Math.sqrt(b)};g.STDEVA=function(){var b=g.VARA.apply(this,arguments);return Math.sqrt(b)};g.STDEVPA=function(){var b=g.VARPA.apply(this,arguments);return Math.sqrt(b)};g.VAR={};g.VAR.P=function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=g.AVERAGE(b),f=0;f<a;f++)c+=Math.pow(b[f]-d,2);return c/a};g.VAR.S=function(){for(var b=e.numbers(e.flatten(arguments)),a=b.length,c=0,d=g.AVERAGE(b),
f=0;f<a;f++)c+=Math.pow(b[f]-d,2);return c/(a-1)};g.VARA=function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=g.AVERAGEA(b),h=0;h<a;h++){var l=b[h];c="number"===typeof l?c+Math.pow(l-f,2):!0===l?c+Math.pow(1-f,2):c+Math.pow(0-f,2);null!==l&&d++}return c/(d-1)};g.VARPA=function(){for(var b=e.flatten(arguments),a=b.length,c=0,d=0,f=g.AVERAGEA(b),h=0;h<a;h++){var l=b[h];c="number"===typeof l?c+Math.pow(l-f,2):!0===l?c+Math.pow(1-f,2):c+Math.pow(0-f,2);null!==l&&d++}return c/d};g.WEIBULL={};
g.WEIBULL.DIST=function(b,a,c,d){b=e.parseNumber(b);a=e.parseNumber(a);c=e.parseNumber(c);return e.anyIsError(b,a,c)?k.value:d?1-Math.exp(-Math.pow(b/c,a)):Math.pow(b,a-1)*Math.exp(-Math.pow(b/c,a))*a/Math.pow(c,a)};g.Z={};g.Z.TEST=function(b,a,c){b=e.parseNumberArray(e.flatten(b));a=e.parseNumber(a);if(e.anyIsError(b,a))return k.value;c=c||g.STDEV.S(b);var d=b.length;return 1-g.NORM.S.DIST((g.AVERAGE(b)-a)/(c/Math.sqrt(d)),!0)};return g}();y.utils=function(){return{PROGRESS:function(g,b){return'<div style="width:'+
(g?g:"0")+"%;height:4px;background-color:"+(b?b:"red")+';margin-top:1px;"></div>'},RATING:function(g){for(var b='<div class="jrating">',a=0;5>a;a++)b=a<g?b+'<div class="jrating-selected"></div>':b+"<div></div>";return b+"</div>"}}}();for(var H=0;H<Object.keys(y).length;H++)for(var C=y[Object.keys(y)[H]],z=Object.keys(C),x=0;x<z.length;x++)if(C[z[x]])if("function"==typeof C[z[x]]||"object"==typeof C[z[x]]){if(w[z[x]]=C[z[x]],w[z[x]].toString=function(){return"#ERROR"},"object"==typeof C[z[x]])for(var J=
Object.keys(C[z[x]]),I=0;I<J.length;I++)w[z[x]][J[I]].toString=function(){return"#ERROR"}}else w[z[x]]=function(){return z[x]+"Not implemented"};else w[z[x]]=function(){return z[x]+"Not implemented"};var F=null,D=null,B=null;w.TABLE=function(){return B};w.COLUMN=w.COL=function(){B.tracking&&B.tracking.push(A.getColumnNameFromCoords(parseInt(F),parseInt(D)));return parseInt(F)+1};w.ROW=function(){B.tracking&&B.tracking.push(A.getColumnNameFromCoords(parseInt(F),parseInt(D)));return parseInt(D)+1};
w.CELL=function(){return A.getColumnNameFromCoords(F,D)};w.VALUE=function(g,b,a){return B.getValueFromCoords(parseInt(g)-1,parseInt(b)-1,a)};w.THISROWCELL=function(g){return B.getValueFromCoords(parseInt(g)-1,parseInt(D))};var K=function(g,b){for(var a=0;a<g.length;a++){var c=A.getTokensFromRange(g[a]);b=b.replace(g[a],"["+c.join(",")+"]")}return b},A=function(g,b,a,c,d){B=d;F=a;D=c;c="";d=Object.keys(b);if(d.length){var f={};for(a=0;a<d.length;a++)if(h=d[a].replace(/!/g,"."),0<h.indexOf(".")){var h=
h.split(".");f[h[0]]={}}h=Object.keys(f);for(a=0;a<h.length;a++)c+="var "+h[a]+" = {};";for(a=0;a<d.length;a++){h=d[a].replace(/!/g,".");if(f=null!==b[d[a]])f=b[d[a]],f=!(!isNaN(f)&&null!==f&&""!==f);f&&(f=b[d[a]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(b[d[a]]=K(f,b[d[a]]));c=0<h.indexOf(".")?c+(h+" = "+b[d[a]]+";\n"):c+("var "+h+" = "+b[d[a]]+";\n")}}g=g.replace(/\$/g,"");g=g.replace(/!/g,".");b="";a=0;d=["=","!",">","<"];for(h=0;h<g.length;h++)'"'==g[h]&&
(a=0==a?1:0),1==a?b+=g[h]:(b+=g[h].toUpperCase(),0<h&&"="==g[h]&&-1==d.indexOf(g[h-1])&&-1==d.indexOf(g[h+1])&&(b+="="));b=b.replace(/\^/g,"**");b=b.replace(/<>/g,"!=");b=b.replace(/&/g,"+");g=b=b.replace(/\$/g,"");(f=g.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g))&&f.length&&(g=K(f,g));c=(new Function(c+"; return "+g))();null===c&&(c=0);return c};A.getColumnNameFromCoords=function(g,b){g=parseInt(g);var a="";701<g?(a+=String.fromCharCode(64+parseInt(g/676)),a+=String.fromCharCode(64+
parseInt(g%676/26))):25<g&&(a+=String.fromCharCode(64+parseInt(g/26)));a+=String.fromCharCode(65+g%26);return a+(parseInt(b)+1)};A.getCoordsFromColumnName=function(g){var b=/^[a-zA-Z]+/.exec(g);if(b){for(var a=0,c=0;c<b[0].length;c++)a+=parseInt(b[0].charCodeAt(c)-64)*Math.pow(26,b[0].length-1-c);a--;0>a&&(a=0);g=parseInt(/[0-9]+$/.exec(g))||null;0<g&&g--;return[a,g]}};A.getRangeFromTokens=function(g){g=g.filter(function(d){return"#REF!"!=d});for(var b="",a="",c=0;c<g.length;c++)0<=g[c].indexOf(".")?
b=".":0<=g[c].indexOf("!")&&(b="!"),b&&(a=g[c].split(b),g[c]=a[1],a=a[0]+b);g.sort(function(d,f){d=Helpers.getCoordsFromColumnName(d);f=Helpers.getCoordsFromColumnName(f);return d[1]>f[1]?1:d[1]<f[1]?-1:d[0]>f[0]?1:d[0]<f[0]?-1:0});return g.length?a+(g[0]+":"+g[g.length-1]):"#REF!"};A.getTokensFromRange=function(g){if(0<g.indexOf(".")){var b=g.split(".");g=b[1];b=b[0]+"."}else 0<g.indexOf("!")?(b=g.split("!"),g=b[1],b=b[0]+"!"):b="";g=g.split(":");var a=A.getCoordsFromColumnName(g[0]),c=A.getCoordsFromColumnName(g[1]);
if(a[0]<=c[0]){g=a[0];var d=c[0]}else g=c[0],d=a[0];if(null===a[1]&&null==c[1])for(var f=null,h=null,l=Object.keys(vars),m=0;m<l.length;m++){var n=A.getCoordsFromColumnName(l[m]);n[0]===a[0]&&(null===f||n[1]<f)&&(f=n[1]);n[0]===c[0]&&(null===h||n[1]>h)&&(h=n[1])}else a[1]<=c[1]?(f=a[1],h=c[1]):(f=c[1],h=a[1]);for(a=[];f<=h;f++){c=[];for(m=g;m<=d;m++)c.push(b+A.getColumnNameFromCoords(m,f));a.push(c)}return a};A.setFormula=function(g){for(var b=Object.keys(g),a=0;a<b.length;a++)"function"==typeof g[b[a]]&&
(w[b[a]]=g[b[a]])};return A};return"undefined"!==typeof window?G(window):null});
